# 강종별 IQR 분석 (Steel Grade IQR Analysis) v2 - 종합 보고서

> **문서 버전**: 2.0
> **작성일**: 2026-02-03
> **목적**: 강종별 IQR 분석에 적용된 필터, A/B 라인 분류, 분석 방법론, 태그 상세 설명 및 추가 수집 필요 태그 종합 정리

---

## 목차

1. [분석 시스템 개요](#1-분석-시스템-개요)
2. [필터 시스템 상세](#2-필터-시스템-상세)
3. [A/B 라인(L1/L2) 분류](#3-ab-라인l1l2-분류)
4. [IQR 분석 방법론](#4-iqr-분석-방법론)
5. [태그 카테고리별 상세 설명](#5-태그-카테고리별-상세-설명)
6. [위험도 분류 기준](#6-위험도-분류-기준)
7. [추가 수집 필요 태그](#7-추가-수집-필요-태그)
8. [분석 실행 가이드](#8-분석-실행-가이드)
9. [부록](#9-부록)

---

## 1. 분석 시스템 개요

### 1.1 시스템 아키텍처

```
┌─────────────────────────────────────────────────────────────────┐
│                    IBA 데이터 분석 시스템                        │
├─────────────────────────────────────────────────────────────────┤
│  ┌─────────────┐  ┌─────────────┐  ┌─────────────┐             │
│  │ ClickHouse  │→ │  필터링     │→ │  IQR 분석   │→ 보고서    │
│  │   (원본)    │  │  엔진       │  │  엔진       │             │
│  └─────────────┘  └─────────────┘  └─────────────┘             │
│         ↓               ↓               ↓                       │
│  v_iba_by_steel   tag_filter_     steel_grade_                  │
│  _grade 뷰        config.yaml     iqr_analysis_v2.py           │
└─────────────────────────────────────────────────────────────────┘
```

### 1.2 강종별 데이터 현황

| 강종 | 레코드 수 | 기간 | 월 수 | 비고 |
|------|-----------|------|-------|------|
| **N5** | 148,239건 | 2025-04 ~ 2025-08 | 5개월 | 최다 데이터 |
| **D5** | 74,855건 | 2025-03 ~ 2025-08 | 6개월 | 최장 기간 |
| **D4** | 20,144건 | 2025-05 ~ 2025-08 | 4개월 | - |
| **B5** | 14,391건 | 2025-04 ~ 2025-08 | 5개월 | 최초 분석 대상 |

### 1.3 태그 현황 요약

| 항목 | 값 |
|------|-----|
| 총 태그 수 | 85개 (분석 대상) |
| 카테고리 수 | 10개 |
| 제외 태그 수 | 9개 (데이터 품질 이슈) |

### 1.4 분석 출력 구조

```
analysis_output/steel_grade_iqr_analysis_v2/
├── B5/
│   ├── 01_Furnace_Top_Temperature/
│   │   ├── *_analysis.png (종합 6패널)
│   │   ├── *_01_timeseries.png
│   │   ├── *_04_daily_avg_trend.png
│   │   ├── *_05_monthly_outlier_rate.png
│   │   └── *_07_daily_outlier_count.png
│   ├── 02_Furnace_Bottom_Temperature/
│   └── ... (기타 카테고리)
├── N5/
├── D5/
└── D4/
```

---

## 2. 필터 시스템 상세

### 2.1 3단계 필터 상속 구조

```
┌─────────────────────────────────────────────────────────────────────┐
│                     3단계 필터 상속 구조                              │
├─────────────────────────────────────────────────────────────────────┤
│  Level 1: 기본값 (defaults)                                         │
│     ↓ 오버라이드                                                     │
│  Level 2: 카테고리별 설정 (categories)                               │
│     ↓ 오버라이드                                                     │
│  Level 3: 태그별 개별 설정 (tag_overrides)                           │
└─────────────────────────────────────────────────────────────────────┘
```

### 2.2 필터 종류 및 정의

#### 2.2.1 RUN 필터 (`run_only`)

| 항목 | 내용 |
|------|------|
| **목적** | 정상 압연 가동 중 데이터만 분석 |
| **조건** | `OPERATION_STATUS = 'RUN'` |
| **제외 대상** | IDLE (정지), TRANS (전환) 상태 |
| **데이터 영향** | 전체의 약 44.6%만 선택 |
| **적용 태그** | **전체 85개 (100%)** |

**적용 근거**: IDLE 상태의 데이터는 설비 미가동 상태로 분석 의미 없음. RUN 상태에서만 실제 공정 데이터가 유효함.

#### 2.2.2 Special-Ops 필터 (`special_ops`)

| 항목 | 내용 |
|------|------|
| **목적** | 특수 작업 구간 제외 |
| **조건** | `MILL_STATUS = 'RUN'` AND `FURNACE_STATUS = 'HOT'` |
| **제외 대상** | 압연기 비가동, 가열로 저온 상태 |
| **데이터 영향** | 가동 중 데이터의 약 90% 선택 |
| **적용 태그** | **전체 85개 (100%)** |

**적용 근거**: 가열로가 HOT 상태가 아니면 정상 공정이 아님. 압연기가 RUN 상태가 아니면 스탠드 데이터 무의미.

#### 2.2.3 Roll-Change 필터 (`roll_change`)

| 항목 | 내용 |
|------|------|
| **목적** | 롤 교환/롤 직경 변경 시 비정상 데이터 제외 |
| **조건 1** | `OPERATION_STATUS != 'TRANS'` |
| **조건 2** | 속도 변화율 < 50% (`speed_spike_threshold`) |
| **제외 대상** | TRANS 상태, 급격한 속도 변화 구간 |
| **데이터 영향** | 약 11% 추가 제외 |
| **적용 태그** | **64개 (75.3%)** - 스탠드 및 핀치롤 태그만 |

**적용 근거**: 롤 교환 시 스탠드 속도/토크/부하가 급변. 가열로 태그는 열관성으로 롤 교환 영향 없음.

#### 2.2.4 Coiling 필터 (`coiling_transient`)

| 항목 | 내용 |
|------|------|
| **목적** | 권취 가속/감속 구간의 비정상 패턴 제외 |
| **조건** | 속도 변화율 ≤ 5% (`coiling_steady_threshold`) |
| **기준 태그** | `PINCHROLL_2_ACTUAL_SPEED` |
| **제외 대상** | 가속 구간 (COIL_START), 감속 구간 (COIL_END) |
| **데이터 영향** | 권취 중 약 15-25% 제외 |
| **적용 태그** | **18개 (21.2%)** - 핀치롤 태그만 |

**적용 근거**: 권취 시작/종료 시 핀치롤 속도/토크가 급변. 정속 구간만 IQR 분석에 포함해야 정상 패턴 파악 가능.

### 2.3 기본 임계값 설정

```yaml
thresholds:
  speed_spike: 0.5         # 롤 교환 감지: 50% 이상 속도 변화
  coiling_steady: 0.05     # 정속 구간 판정: 5% 이하 변화율
  coiling_window: 5        # 이동평균 윈도우 크기 (초)
```

### 2.4 카테고리별 필터 적용 현황

| 카테고리 | 태그 수 | RUN | Special-Ops | Roll-Change | Coiling | 비고 |
|----------|:------:|:---:|:-----------:|:-----------:|:-------:|------|
| 01_Furnace_Top_Temperature | 4 | ✅ | ✅ | ❌ | ❌ | 열관성으로 롤교환 무관 |
| 02_Furnace_Bottom_Temperature | 4 | ✅ | ✅ | ❌ | ❌ | 열관성으로 롤교환 무관 |
| 03_Furnace_Discharge_Temperature | 1 | ✅ | ✅ | ❌ | ❌ | 압연 전 측정 |
| 04_Furnace_Auxiliary | 10 | ✅ | ✅ | ❌ | ❌ | 독립 시스템 |
| 05_Stand_Torque | 16 | ✅ | ✅ | ✅ | ❌ | 롤교환 시 토크 급변 |
| 06_Stand_Speed | 15 | ✅ | ✅ | ✅ | ❌ | 롤교환 감지 기준 |
| 07_Stand_Load | 15 | ✅ | ✅ | ✅ | ❌ | 토크/속도 함수 |
| 08_Pinchroll | 12 | ✅ | ✅ | ✅ | ✅ | 권취 영향 큼 |
| 09_Cooling_Water | 2 | ✅ | ✅ | ❌ | ❌ | 독립 냉각 시스템 |
| 10_PR_Detailed | 6 | ✅ | ✅ | ✅ | ✅ | 권취 직접 연동 |

### 2.5 필터별 적용 태그 분포

```
RUN 필터:        ████████████████████████████████████████ 85/85 (100%)
Special-Ops:     ████████████████████████████████████████ 85/85 (100%)
Roll-Change:     ██████████████████████████████░░░░░░░░░░ 64/85 (75.3%)
Coiling:         ████████░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░ 18/85 (21.2%)
```

### 2.6 필터 프리셋

| 프리셋 | 설명 | run_only | special_ops | roll_change | coiling_transient |
|--------|------|:--------:|:-----------:|:-----------:|:-----------------:|
| **P0_RAW** | 전체 데이터 (필터 없음) | ❌ | ❌ | ❌ | ❌ |
| **P1_BASIC** | 기본 IQR 분석 (RUN만) | ✅ | ❌ | ❌ | ❌ |
| **P2_OPTIMAL** | 정상 가동 분석 | ✅ | ✅ | ❌ | ❌ |
| **P3_STRICT** | 최고 품질 분석 | ✅ | ✅ | ✅ | ✅ |
| **P4_PER_TAG** | 태그별 최적화 **(권장)** | 태그별 | 태그별 | 태그별 | 태그별 |

---

## 3. A/B 라인(L1/L2) 분류

### 3.1 VCC 권취 영역 이중 라인 구조

VCC(Vertical Coil Collector) 권취 영역은 **이중 라인 구조**로 설계되어 있습니다:

- **Line 1 (L1)**: VCC 권취 라인 1 - 첫 번째 권취 스테이션
- **Line 2 (L2)**: VCC 권취 라인 2 - 두 번째 권취 스테이션

```
┌─────────────────────────────────────────────────────────────────┐
│                    VCC (Variable Cooling Control)               │
├─────────────────────────────────────────────────────────────────┤
│                                                                 │
│    압연 완료 → ┌─────┐ → ┌─────┐ → ┌─────┐ → ┌─────┐          │
│               │ PR6 │   │ PR7 │   │ PR8 │   │ PR9 │          │
│               └──┬──┘   └──┬──┘   └──┬──┘   └──┬──┘          │
│                  │         │         │         │              │
│         ┌───────┴───────┬─┴─────────┴─────────┘              │
│         │               │                                     │
│     ┌───┴───┐       ┌───┴───┐                                │
│     │  L1   │       │  L2   │                                │
│     │ 라인  │       │ 라인  │                                │
│     └───┬───┘       └───┬───┘                                │
│         │               │                                     │
│         ▼               ▼                                     │
│     [코일러1]       [코일러2]                                 │
│                                                               │
└─────────────────────────────────────────────────────────────────┘
```

### 3.2 라인별 태그 분류

#### 3.2.1 L1/L2 모두 수집되는 설비 (완전 구분 가능)

| 설비 | L1 태그 | L2 태그 | 분석 방식 |
|------|---------|---------|-----------|
| **PR6** | PR6L1_ACT_TORQUE | PR6L2_ACT_TORQUE | 독립 IQR |
| **PR7** | PR7L1_ACT_TORQUE | PR7L2_ACT_TORQUE | 독립 IQR |

#### 3.2.2 L1만 수집되는 설비 (부분 구분)

| 설비 | L1 태그 | L2 태그 | 비고 |
|------|---------|---------|------|
| **PR8** | PR8L1_ACT_TORQUE | ❌ 미수집 | L2 데이터 없음 |
| **PR9** | PR9L1_ACT_TORQUE | ❌ 미수집 | L2 데이터 없음 |

### 3.3 L1/L2 분석 시 고려사항

| 항목 | 내용 |
|------|------|
| **독립 분석 필요성** | L1과 L2는 별도의 모터와 제어 시스템을 사용하므로 독립 분석 필수 |
| **시간대별 활성 라인** | L1 가동 시 L2 정지 가능 (교대 운전) |
| **통계 분석 왜곡 방지** | 혼합 분석 시 IQR 범위가 비정상적으로 넓어짐 |
| **0값 필터링** | 비가동 라인의 0값은 분석에서 제외 필요 |

### 3.4 혼합 분석의 문제점 예시

```
[잘못된 혼합 분석]
L1 토크 분포: [10, 15, 20, 25]  → IQR_L1 = 10
L2 토크 분포: [50, 55, 60, 65]  → IQR_L2 = 10
혼합 분포: [10, 15, 20, 25, 50, 55, 60, 65]
→ 혼합 IQR = 40 (실제 각 라인 IQR의 4배!)
→ 정상범위가 비정상적으로 넓어져 이상치 미탐지

[올바른 분리 분석]
L1: 별도 IQR 계산 → 이상치율 정확
L2: 별도 IQR 계산 → 이상치율 정확
```

---

## 4. IQR 분석 방법론

### 4.1 IQR 기반 이상치 탐지 공식

```
Q1 = 25번째 백분위수
Q3 = 75번째 백분위수
IQR = Q3 - Q1

하한 경계 = Q1 - 1.5 × IQR
상한 경계 = Q3 + 1.5 × IQR

이상치: 값 < 하한 경계 OR 값 > 상한 경계
```

### 4.2 시각화 개념도

```
     하한 경계                          상한 경계
         │          정상 범위              │
    ─────┼──────────────────────────────────┼─────
         │    [Q1]────[IQR]────[Q3]        │
    ─────┼──────────────────────────────────┼─────
  이상치 │                                  │ 이상치
```

### 4.3 전역 IQR vs 강종별 IQR

| 방법 | 테이블 | 장점 | 단점 | 적용 상황 |
|------|--------|------|------|----------|
| **전역 IQR** | `iba_tag_iqr_bounds` | 단순, 빠름 | 강종 특성 무시 | 설비 모니터링 |
| **강종별 IQR** | `iba_steel_grade_iqr_bounds` | 정밀, 강종 특성 반영 | 소량 강종 신뢰도↓ | 품질 분석 **(권장)** |

### 4.4 분석 차트 구성

#### 개별 차트 (7개)

| # | 차트 | 파일 접미사 | 설명 |
|---|------|-------------|------|
| 01 | 시계열 | `_01_timeseries.png` | 전체 기간 시계열 |
| 02 | 히스토그램 | `_02_histogram.png` | 값 분포 |
| 03 | 박스플롯 | `_03_boxplot.png` | IQR 시각화 |
| 04 | 일별 평균 추이 | `_04_daily_avg_trend.png` | 일별 평균 변화 |
| 05 | 월별 이상치율 | `_05_monthly_outlier_rate.png` | 월별 이상치율 |
| 06 | 시간대별 히트맵 | `_06_hourly_heatmap.png` | 시간대별 패턴 |
| 07 | 일별 이상치 건수 | `_07_daily_outlier_count.png` | 일별 이상치 수 |

#### 종합 차트 (6패널)

```
┌─────────────────┬─────────────────┐
│ 1. 시계열       │ 2. 히스토그램   │
├─────────────────┼─────────────────┤
│ 3. 박스플롯     │ 4. 일별 추이    │
├─────────────────┼─────────────────┤
│ 5. 월별 이상치  │ 6. 시간대 히트맵│
└─────────────────┴─────────────────┘
```

### 4.5 컨텍스트 인식 분석

운영 상태를 고려한 이상치 판정:

| 상태 | 설명 | 분석 활용 |
|:----:|------|----------|
| `RUN` | 정상 압연 운전 중 | 품질 분석의 핵심 데이터 |
| `TRANS` | 전환 상태 (시작/종료) | 과도 상태 분석 |
| `IDLE` | 대기 상태 | 이상치 분석에서 제외 권장 |

---

## 5. 태그 카테고리별 상세 설명

### 5.1 전체 카테고리 개요

| # | 카테고리 | 태그 수 | 설명 | 설비 위치 |
|---|----------|:-------:|------|----------|
| 01 | Furnace_Top_Temperature | 4 | 가열로 상부 온도 | 상류 (가열로) |
| 02 | Furnace_Bottom_Temperature | 4 | 가열로 하부 온도 | 상류 (가열로) |
| 03 | Furnace_Discharge_Temperature | 1 | 가열로 추출 온도 | 상류 (가열로 출구) |
| 04 | Furnace_Auxiliary | 10 | 가열로 부대설비 | 상류 (가열로) |
| 05 | Stand_Torque | 16 | 스탠드 토크 | 중류 (압연기) |
| 06 | Stand_Speed | 15 | 스탠드 속도 | 중류 (압연기) |
| 07 | Stand_Load | 15 | 스탠드 부하 | 중류 (압연기) |
| 08 | Pinchroll | 12 | 핀치롤 | 하류 (냉각 후) |
| 09 | Cooling_Water | 2 | 냉각수 | 중류 (냉각대) |
| 10 | PR_Detailed | 6 | 핀치롤 상세 (L1/L2) | 하류 (권취 전) |

### 5.2 카테고리별 태그 상세

#### 01_Furnace_Top_Temperature (4개)

| 태그명 | 한글명 | 단위 |
|--------|--------|------|
| HEATING_TOP_ZONE_NO_1_TEMPERATURE_ROOF | 가열대 1존 상부 온도 | °C |
| HEATING_TOP_ZONE_NO_2_TEMPERATURE_ROOF | 가열대 2존 상부 온도 | °C |
| SOAKING_TOP_ZONE_NO_1_TEMPERATURE_ROOF | 균열대 1존 상부 온도 | °C |
| SOAKING_TOP_ZONE_NO_2_TEMPERATURE_ROOF | 균열대 2존 상부 온도 | °C |

**특성**: 가열로 내부 상부(천정) 영역의 온도. 열관성이 커서 롤 교환/권취 영향 없음.

#### 02_Furnace_Bottom_Temperature (4개)

| 태그명 | 한글명 | 단위 |
|--------|--------|------|
| HEATING_BOTTOM_ZONE_NO_1_TEMPERATURE_OPP_SIDE | 가열대 1존 하부 온도 (반대측) | °C |
| HEATING_BOTTOM_ZONE_NO_2_TEMPERATURE_MILL_SIDE | 가열대 2존 하부 온도 (밀측) | °C |
| SOAKING_BOTTOM_ZONE_NO_1_TEMPERATURE_OPP_SIDE | 균열대 1존 하부 온도 (반대측) | °C |
| SOAKING_BOTTOM_ZONE_NO_2_TEMPERATURE_MILL_SIDE | 균열대 2존 하부 온도 (밀측) | °C |

**특성**: OPP_SIDE는 반대측, MILL_SIDE는 압연기측을 의미.

#### 03_Furnace_Discharge_Temperature (1개)

| 태그명 | 한글명 | 단위 |
|--------|--------|------|
| FURNACE_EXIT_DISCHARGE_BILLET_TEMPERATURE | 가열로 추출 빌렛 온도 | °C |

**특성**: 가열로에서 빌렛이 추출될 때 측정되는 온도. 압연 품질에 직접적 영향.

#### 04_Furnace_Auxiliary (10개)

| 태그명 | 한글명 | 단위 |
|--------|--------|------|
| COMBUSTION_AIR_TEMPERATURE | 연소 공기 온도 | °C |
| FURNACE_O2_ANALYZER | 가열로 산소 분석 | % |
| FURNACE_PRESSURE | 가열로 내부 압력 | Pa |
| INDIRECT_COOLING_WATER_FLOW | 간접 냉각수 유량 | m³/h |
| INDIRECT_WATER_MAIN_TEMPERATURE | 간접 냉각수 주 온도 | °C |
| MAIN_COMBUSTION_AIR_PRESSURE | 주 연소 공기 압력 | kPa |
| MAIN_GAS_FLOW | 주 가스 유량 | Nm³/h |
| MAIN_GAS_PRESSURE | 주 가스 압력 | kPa |
| MAIN_GAS_TEMPERATURE | 주 가스 온도 | °C |
| FURNACE_HYDRAULIC_TANK_OIL_TEMPERATURE | 유압 탱크 오일 온도 | °C |

**특성**: 연소 시스템, 유압 시스템, 배기 시스템 관련. 독립 제어 시스템으로 운영.

#### 05_Stand_Torque (16개)

| 태그명 | 한글명 |
|--------|--------|
| STAND_1_ACTUAL_TORQUE ~ STAND_14_ACTUAL_TORQUE | 스탠드 1~14 실제 토크 |
| FINISHING_BLOCK_MASTER_ACTUAL_TORQUE | 피니싱 블록 마스터 토크 |
| FINISHING_BLOCK_SLAVE_ACTUAL_TORQUE | 피니싱 블록 슬레이브 토크 |

**특성**: 압연 부하의 직접 지표. 롤 교환 시 토크가 급변하므로 Roll-Change 필터 적용.

#### 06_Stand_Speed (15개)

| 태그명 | 한글명 |
|--------|--------|
| STAND_1_ACTUAL_SPEED ~ STAND_14_ACTUAL_SPEED | 스탠드 1~14 실제 속도 |
| FINISHING_BLOCK_ACTUAL_SPEED | 피니싱 블록 속도 |

**특성**: `STAND_1_ACTUAL_SPEED`는 **롤 교환 감지의 기준 태그**로 사용됨.

#### 07_Stand_Load (15개)

| 태그명 | 한글명 |
|--------|--------|
| STAND_1_LOAD ~ STAND_14_LOAD | 스탠드 1~14 부하 |
| FINISHING_BLOCK_LOAD | 피니싱 블록 부하 |

**특성**: 부하(Load) = f(토크, 속도) 관계로 계산됨.

#### 08_Pinchroll (12개)

| 태그명 | 한글명 |
|--------|--------|
| PINCHROLL_2/3/4_ACTUAL_SPEED | 핀치롤 2/3/4 실제 속도 |
| PINCHROLL_2/3/4_ACTUAL_TORQUE | 핀치롤 2/3/4 실제 토크 |
| PINCHROLL_2/3/4_REFERENCE_SPEED | 핀치롤 2/3/4 기준 속도 |
| PINCHROLL_2/3/4_REFERENCE_TORQUE | 핀치롤 2/3/4 기준 토크 |

**특성**: **모든 필터 적용**. 권취기 직전에 위치하여 권취 작업과 직접 연동.

#### 10_PR_Detailed (6개) - L1/L2 라인

| 태그명 | 라인 | 설명 |
|--------|:----:|------|
| PR6L1_ACT_TORQUE | L1 | 핀치롤 6 L1 토크 |
| PR6L2_ACT_TORQUE | L2 | 핀치롤 6 L2 토크 |
| PR7L1_ACT_TORQUE | L1 | 핀치롤 7 L1 토크 |
| PR7L2_ACT_TORQUE | L2 | 핀치롤 7 L2 토크 |
| PR8L1_ACT_TORQUE | L1 | 핀치롤 8 L1 토크 |
| PR9L1_ACT_TORQUE | L1 | 핀치롤 9 L1 토크 |

**특성**: **모든 필터 적용**. PR6~PR9는 하류 핀치롤로 권취기에 가까움.

---

## 6. 위험도 분류 기준

### 6.1 이상치율 기반 위험도

| 등급 | 이상치율 | 의미 | 권장 조치 |
|:----:|:--------:|------|-----------|
| 🔴 **CRITICAL** | ≥25% | 심각한 이상 | 즉시 점검 필요 |
| 🟠 **DANGER** | ≥15% | 높은 위험 | 조속한 점검 권고 |
| 🟡 **WARNING** | ≥10% | 주의 필요 | 모니터링 강화 |
| 🔵 **CAUTION** | ≥5% | 경미한 이상 | 정기 점검 시 확인 |
| 🟢 **NORMAL** | <5% | 정상 범위 | 일반 관리 |

### 6.2 위험도 시각화

```
이상치율 0%      5%       10%      15%      25%      50%
         │       │        │        │        │        │
         ├───────┼────────┼────────┼────────┼────────┤
         │🟢     │🔵      │🟡      │🟠      │🔴      │
         │NORMAL │CAUTION │WARNING │DANGER  │CRITICAL│
         └───────┴────────┴────────┴────────┴────────┘
```

---

## 7. 추가 수집 필요 태그

### 7.1 현재 태그 구조의 취약점

현재 217개 IBA 태그 중 **권취 품질 개선**에 필수적인 다음 영역의 데이터가 **전무**:

| 영역 | 현재 태그 | 커버리지 | 평가 |
|------|:---------:|:--------:|:----:|
| 레잉헤드 (Laying Head) | **0개** | 0% | ❌ 심각 |
| 스텔모어/냉각대 (Stelmor) | **0개** | 0% | ❌ 심각 |
| VCC (권취기) | **0개** | 0% | ❌ 심각 |
| 코일 품질 실적 | **0개** | 0% | ❌ 심각 |

### 7.2 추가 수집 필요 태그 목록

#### 7.2.1 레잉헤드 (Laying Head) - **최우선**

| 우선순위 | 태그명 (권장) | 측정 유형 | 품질 영향도 |
|:--------:|---------------|-----------|-------------|
| ⭐⭐⭐ | `LAYING_HEAD_ACTUAL_SPEED` | 속도(실적) rpm | 루프 직경 결정 |
| ⭐⭐⭐ | `LAYING_HEAD_PIPE_ANGLE` | 각도 ° | 루프 형상 |
| ⭐⭐⭐ | `LAYING_HEAD_EXIT_TEMPERATURE` | 온도 °C | 냉각 시작점 |
| ⭐⭐ | `LAYING_HEAD_MOTOR_TORQUE` | 토크 % | 이상 감지 |

#### 7.2.2 스텔모어/냉각대 (Stelmor) - **최우선**

| 우선순위 | 태그명 (권장) | 측정 유형 | 품질 영향도 |
|:--------:|---------------|-----------|-------------|
| ⭐⭐⭐ | `STELMOR_FAN_1~10_SPEED` | 속도 rpm/% | 냉각속도 제어 |
| ⭐⭐⭐ | `STELMOR_COVER_1~10_POSITION` | 개폐 | 공냉 제어 |
| ⭐⭐⭐ | `STELMOR_ROLLER_SPEED_ZONE_1~10` | 속도 m/min | 루프 간격 |
| ⭐⭐⭐ | `STELMOR_ZONE_TEMPERATURE_1~10` | 온도 °C | 냉각 프로파일 |

#### 7.2.3 VCC (Vertical Coil Collector) - **최우선**

| 우선순위 | 태그명 (권장) | 측정 유형 | 품질 영향도 |
|:--------:|---------------|-----------|-------------|
| ⭐⭐⭐ | `VCC1/2_VERTICAL_POSITION` | 위치 mm | 코일 형상 |
| ⭐⭐⭐ | `VCC1/2_ROTATION_SPEED` | 속도 rpm | 분배 균일성 |
| ⭐⭐⭐ | `VCC1/2_DISTRIBUTOR_POSITION` | 위치 ° | 코일 충전 |
| ⭐⭐ | `VCC_CONTAINMENT_ROLL_POSITION` | 위치 mm | 코일 외경 |

#### 7.2.4 코일 품질 실적 - **필수**

| 우선순위 | 태그명 (권장) | 측정 유형 | 품질 영향도 |
|:--------:|---------------|-----------|-------------|
| ⭐⭐⭐ | `COIL_WEIGHT_ACTUAL` | 무게 kg | 생산 실적 |
| ⭐⭐⭐ | `COIL_OUTER_DIAMETER` | 외경 mm | 형상 품질 |
| ⭐⭐⭐ | `COIL_INNER_DIAMETER` | 내경 mm | 형상 품질 |
| ⭐⭐⭐ | `COIL_HEIGHT` | 높이 mm | 형상 품질 |
| ⭐⭐⭐ | `COIL_LENGTH` | 길이 m | 생산 실적 |

### 7.3 태그 수집 우선순위 Phase

| Phase | 영역 | 추가 태그 수 | 예상 효과 |
|:-----:|------|:------------:|-----------|
| **1** | 레잉헤드, 스텔모어, VCC, 코일품질 | ~40개 | 권취 품질 분석 기반 확보 |
| **2** | 수냉대, 장력제어, 온도측정 | ~20개 | 정밀 분석 역량 강화 |
| **3** | 결속/이송, 품질검사, 에너지 | ~15개 | 스마트 팩토리 고도화 |

### 7.4 추가 태그 수집 시 예상 분석 가능 항목

| 분석 항목 | 현재 | 추가 후 |
|-----------|:----:|:-------:|
| 코일 형상 불량 원인 분석 | ❌ | ✅ |
| 냉각 속도와 재질 특성 상관관계 | ❌ | ✅ |
| 레잉헤드 속도-루프 직경 관계 | ❌ | ✅ |
| VCC 설정-코일 충전 균일성 | ❌ | ✅ |
| 품질 개선 효과 정량 측정 | ❌ | ✅ |

---

## 8. 분석 실행 가이드

### 8.1 기본 실행

```bash
# 단일 강종 분석
./venv/bin/python scripts/steel_grade_iqr_analysis_v2.py --grade B5

# 전체 강종 순차 분석
for grade in N5 D5 D4 B5; do
    ./venv/bin/python scripts/steel_grade_iqr_analysis_v2.py --grade $grade
done
```

### 8.2 필터 프리셋 사용

```bash
# 권장: 태그별 최적화 필터 사용
./venv/bin/python scripts/steel_grade_iqr_analysis_v2.py \
    --grade B5 \
    --filter-preset P4_PER_TAG
```

### 8.3 출력 확인

- **종합 차트**: `*_analysis.png` - 6패널 종합 분석
- **개별 차트**: `*_01~07.png` - 상세 분석별 차트
- **보고서**: 각 태그별 분석 결과

---

## 9. 부록

### 9.1 제외 태그 목록 (데이터 품질 이슈)

| 태그명 | 제외 사유 |
|--------|-----------|
| ENTRY_MILL_PINCHROLL_ACTUAL_SPEED | ALL_ZEROS - 항상 0값 |
| ENTRY_MILL_PINCHROLL_REFERENCE_SPEED | ALL_ZEROS - 항상 0값 |
| EXIT_FURNACE_RT_SEC_1_ACTUAL_SPEED | LOW_VARIANCE - 변동성 부족 |
| EXIT_FURNACE_RT_SEC_1_REFERENCE_SPEED | LOW_VARIANCE - 변동성 부족 |
| EXIT_FURNACE_RT_SEC_2_ACTUAL_SPEED | LOW_VARIANCE - 변동성 부족 |
| EXIT_FURNACE_RT_SEC_2_REFERENCE_SPEED | LOW_VARIANCE - 변동성 부족 |
| DR01BFZI1_PRESENCE_AT_FURNACE_EXIT_SIDE | ALL_ZEROS - 항상 0값 |
| DR01BFZI2_PRESENCE_AT_DISCHARGING_POSITION_ROLLS_8_9_SEC_1 | ALL_ZEROS - 항상 0값 |
| Y165 | CONSTANT - 상수값 |

### 9.2 용어집

| 용어 | 정의 |
|------|------|
| IQR | 사분위수 범위 (Interquartile Range) = Q3 - Q1 |
| 이상치 | IQR 기준 1.5배 범위를 벗어난 값 |
| 강종 | 강철의 종류/등급 (Steel Grade) |
| VCC | Vertical Coil Collector - 수직형 코일 집적기 |
| 핀치롤 | 철강재를 밀어주는 롤러 |
| 가열대 | 빌렛을 가열하는 구역 (Heating Zone) |
| 균열대 | 온도를 균일하게 하는 구역 (Soaking Zone) |
| 레잉헤드 | 선재를 나선형 루프로 성형하는 설비 |
| 스텔모어 | 선재 공냉 냉각 컨베이어 시스템 |

### 9.3 관련 문서

| 문서 | 위치 | 설명 |
|------|------|------|
| 필터 설정 보고서 | `docs/TAG_FILTER_CONFIGURATION_REPORT_KO.md` | 상세 필터 설정 |
| 분석 방법론 | `docs/IBA_DATA_ANALYSIS_METHODOLOGY_KO.md` | 분석 방법론 상세 |
| 태그 상세 목록 | `docs/IBA_태그_상세_목록.md` | 전체 태그 목록 및 추가 수집 필요 태그 |
| 분석 설정 종합 | `docs/IBA_분석설정_종합문서.md` | 종합 설정 문서 |

### 9.4 설정 파일 위치

| 파일 | 경로 | 용도 |
|------|------|------|
| tag_filter_config.yaml | `config/` | 필터 설정 |
| steel_grade_iqr_analysis_v2.py | `scripts/` | 분석 스크립트 |

---

**문서 이력**
| 버전 | 날짜 | 변경 내용 |
|------|------|-----------|
| 2.0 | 2026-02-03 | 종합 보고서 작성 - 4개 참조 문서 통합 |

---

*이 문서는 DH Steel IBA 데이터 프로파일링 프로젝트의 공식 참조 문서입니다.*
